{{#with idea}}
<div class="p-5 mb-4 bg-light rounded-3 shadow-sm">
  <div class="container-fluid py-5">
    
    <div class="d-flex justify-content-between align-items-start">
        <div>
            <h1 class="display-5 fw-bold">{{title}}</h1>
            <span class="badge bg-primary fs-6 mb-3">{{category}}</span>
        </div>
        <div class="text-end">
            <h3 class="text-success fw-bold"><i class="fas fa-vote-yea"></i> {{votes.length}} Votos</h3>
            {{#if ../userHasVoted}}
                <span class="badge bg-success"><i class="fas fa-check"></i> Você já votou</span>
            {{/if}}
        </div>
    </div>

    <p class="col-md-10 fs-4">{{description}}</p>

    <hr class="my-4">

    {{#if ../user}}
      {{!-- Botão de Votar (se ainda não votou) --}}
      {{#unless ../userHasVoted}}
        <form action="/ideas/vote/{{_id}}" method="POST" class="d-inline">
          <button class="btn btn-success btn-lg" type="submit"><i class="fas fa-thumbs-up"></i> Votar Agora</button>
        </form>
      {{/unless}}

      {{!-- Controles do Autor (requer 'isAuthor' do backend) --}}
      {{#if ../isAuthor}}
        <a href="/ideas/edit/{{_id}}" class="btn btn-warning btn-lg"><i class="fas fa-edit"></i> Editar</a>
        
        {{!-- Botão de Excluir (requer method-override no backend) --}}
        <form action="/ideas/delete/{{_id}}?_method=DELETE" method="POST" class="d-inline ms-2" onsubmit="return confirm('Tem certeza que deseja excluir esta ideia?');">
          <button type="submit" class="btn btn-danger btn-lg"><i class="fas fa-trash"></i> Excluir</a >
        </form>
      {{/if}}

    {{else}}
      <div class="alert alert-info">
        <a href="/login">Faça login</a> para votar nesta ideia.
      </div>
    {{/if}}

    <a href="/" class="btn btn-outline-secondary btn-lg ms-2"><i class="fas fa-arrow-left"></i> Voltar</a>
  </div>
</div>
{{/with}}